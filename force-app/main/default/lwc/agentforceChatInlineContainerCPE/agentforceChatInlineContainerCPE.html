<template>
    <!-- DISPLAY SECTION -->
    <div class="slds-card slds-card_boundary">
        <div class="section-header" onclick={toggleDisplay}>
            <lightning-icon icon-name={displayIconName} size="xx-small"></lightning-icon>
            <span class="section-title">Display Settings</span>
        </div>
        <template lwc:if={isDisplayExpanded}>
            <div class="section-content">
                <lightning-combobox
                    label="Height"
                    value={height}
                    options={heightOptions}
                    onchange={handleHeightChange}>
                </lightning-combobox>

                <lightning-slider
                    label="Width (%)"
                    value={widthPercent}
                    min="50"
                    max="100"
                    step="5"
                    onchange={handleWidthChange}>
                </lightning-slider>

                <lightning-input
                    type="checkbox"
                    label="Show Welcome Screen"
                    checked={showWelcomeScreen}
                    onchange={handleShowWelcomeScreenChange}
                    field-level-help="Display the custom welcome screen before chat starts">
                </lightning-input>
            </div>
        </template>
    </div>

    <!-- APPEARANCE SECTION -->
    <div class="slds-card slds-card_boundary">
        <div class="section-header" onclick={toggleAppearance}>
            <lightning-icon icon-name={appearanceIconName} size="xx-small"></lightning-icon>
            <span class="section-title">Appearance</span>
        </div>
        <template lwc:if={isAppearanceExpanded}>
            <div class="section-content">
                <div class="color-field">
                    <label class="color-label">Agent Icon Color</label>
                    <div class="color-picker-row">
                        <input
                            type="color"
                            value={agentPrimaryColor}
                            onchange={handleAgentPrimaryColorChange}
                            class="color-swatch">
                        <lightning-input
                            type="text"
                            value={agentPrimaryColor}
                            onchange={handleAgentPrimaryColorChange}
                            class="color-hex-input"
                            variant="label-hidden">
                        </lightning-input>
                    </div>
                </div>

                <div class="color-field">
                    <label class="color-label">Send Button Color</label>
                    <div class="color-picker-row">
                        <input
                            type="color"
                            value={sendButtonColor}
                            onchange={handleSendButtonColorChange}
                            class="color-swatch">
                        <lightning-input
                            type="text"
                            value={sendButtonColor}
                            onchange={handleSendButtonColorChange}
                            class="color-hex-input"
                            variant="label-hidden">
                        </lightning-input>
                    </div>
                </div>

                <lightning-input
                    type="checkbox"
                    label="Customize Background Gradient"
                    checked={customizeGradient}
                    onchange={handleCustomizeGradientToggle}>
                </lightning-input>

                <template lwc:if={showGradientControls}>
                    <div class="nested-controls">
                        <div class="color-field">
                            <label class="color-label">Gradient Start (Top)</label>
                            <div class="color-picker-row">
                                <input
                                    type="color"
                                    value={gradientStartColor}
                                    onchange={handleGradientStartColorChange}
                                    class="color-swatch">
                                <lightning-input
                                    type="text"
                                    value={gradientStartColor}
                                    onchange={handleGradientStartColorChange}
                                    class="color-hex-input"
                                    variant="label-hidden">
                                </lightning-input>
                            </div>
                        </div>

                        <div class="color-field">
                            <label class="color-label">Gradient Middle</label>
                            <div class="color-picker-row">
                                <input
                                    type="color"
                                    value={gradientMidColor}
                                    onchange={handleGradientMidColorChange}
                                    class="color-swatch">
                                <lightning-input
                                    type="text"
                                    value={gradientMidColor}
                                    onchange={handleGradientMidColorChange}
                                    class="color-hex-input"
                                    variant="label-hidden">
                                </lightning-input>
                            </div>
                        </div>

                        <div class="color-field">
                            <label class="color-label">Gradient End (Bottom)</label>
                            <div class="color-picker-row">
                                <input
                                    type="color"
                                    value={gradientEndColor}
                                    onchange={handleGradientEndColorChange}
                                    class="color-swatch">
                                <lightning-input
                                    type="text"
                                    value={gradientEndColor}
                                    onchange={handleGradientEndColorChange}
                                    class="color-hex-input"
                                    variant="label-hidden">
                                </lightning-input>
                            </div>
                        </div>
                    </div>
                </template>
            </div>
        </template>
    </div>

    <!-- WELCOME & BRANDING SECTION -->
    <div class="slds-card slds-card_boundary">
        <div class="section-header" onclick={toggleWelcome}>
            <lightning-icon icon-name={welcomeIconName} size="xx-small"></lightning-icon>
            <span class="section-title">Welcome &amp; Branding</span>
        </div>
        <template lwc:if={isWelcomeExpanded}>
            <div class="section-content">
                <lightning-input
                    label="Welcome Title"
                    value={welcomeTitle}
                    onchange={handleWelcomeTitleChange}
                    placeholder="How can Agentforce help?">
                </lightning-input>

                <div class="color-field">
                    <label class="color-label">Title Color</label>
                    <div class="color-picker-row">
                        <input
                            type="color"
                            value={welcomeTitleColor}
                            onchange={handleWelcomeTitleColorChange}
                            class="color-swatch">
                        <lightning-input
                            type="text"
                            value={welcomeTitleColor}
                            onchange={handleWelcomeTitleColorChange}
                            class="color-hex-input"
                            variant="label-hidden">
                        </lightning-input>
                    </div>
                </div>

                <lightning-textarea
                    label="Welcome Message"
                    value={welcomeMessage}
                    onchange={handleWelcomeMessageChange}
                    placeholder="Ask questions, get personalized answers, and take action with Agentforce.">
                </lightning-textarea>

                <lightning-input
                    type="checkbox"
                    label="Customize Callout Word"
                    checked={customizeCalloutWord}
                    onchange={handleCustomizeCalloutWordToggle}
                    field-level-help="Style a word in the welcome title differently">
                </lightning-input>

                <template lwc:if={showCalloutWordControls}>
                    <div class="nested-controls">
                        <lightning-input
                            label="Callout Word"
                            value={calloutWord}
                            onchange={handleCalloutWordChange}
                            placeholder="Word to highlight">
                        </lightning-input>

                        <div class="color-field">
                            <label class="color-label">Callout Color</label>
                            <div class="color-picker-row">
                                <input
                                    type="color"
                                    value={calloutColor}
                                    onchange={handleCalloutColorChange}
                                    class="color-swatch">
                                <lightning-input
                                    type="text"
                                    value={calloutColor}
                                    onchange={handleCalloutColorChange}
                                    class="color-hex-input"
                                    variant="label-hidden">
                                </lightning-input>
                            </div>
                        </div>

                        <div class="style-buttons-container">
                            <label class="style-buttons-label">Text Style</label>
                            <div class="style-buttons">
                                <lightning-button
                                    variant={boldButtonVariant}
                                    label="B"
                                    title="Bold"
                                    onclick={handleBoldToggle}
                                    class={boldButtonClass}>
                                </lightning-button>
                                <lightning-button
                                    variant={italicButtonVariant}
                                    label="I"
                                    title="Italic"
                                    onclick={handleItalicToggle}
                                    class={italicButtonClass}>
                                </lightning-button>
                            </div>
                        </div>

                        <template lwc:if={calloutBold}>
                            <lightning-combobox
                                label="Font Weight"
                                value={calloutFontWeight}
                                options={fontWeightOptions}
                                onchange={handleCalloutFontWeightChange}>
                            </lightning-combobox>
                        </template>
                    </div>
                </template>
            </div>
        </template>
    </div>

    <!-- SEARCH SETTINGS SECTION -->
    <div class="slds-card slds-card_boundary">
        <div class="section-header" onclick={toggleSearch}>
            <lightning-icon icon-name={searchIconName} size="xx-small"></lightning-icon>
            <span class="section-title">Search Page Settings</span>
        </div>
        <template lwc:if={isSearchExpanded}>
            <div class="section-content">
                <lightning-input
                    type="checkbox"
                    label="Auto-Detect Search Query"
                    checked={autoDetectSearchQuery}
                    onchange={handleAutoDetectSearchQueryChange}
                    field-level-help="Automatically detect and send search query from URL when on a search page">
                </lightning-input>

                <template lwc:if={autoDetectSearchQuery}>
                    <lightning-input
                        label="Search Page Path"
                        value={searchPagePath}
                        onchange={handleSearchPagePathChange}
                        placeholder="/global-search"
                        field-level-help="URL path pattern to identify search pages (e.g., /global-search)">
                    </lightning-input>

                    <lightning-input
                        label="Search Query Parameter"
                        value={searchQueryParam}
                        onchange={handleSearchQueryParamChange}
                        placeholder="term"
                        field-level-help="URL parameter containing the search query (e.g., 'term' for ?term=search)">
                    </lightning-input>

                    <lightning-input
                        type="checkbox"
                        label="New Chat Per Search"
                        checked={searchStartsNewChat}
                        onchange={handleSearchStartsNewChatChange}
                        field-level-help="When enabled, each search starts a fresh conversation. When disabled, search continues the existing conversation.">
                    </lightning-input>
                </template>
            </div>
        </template>
    </div>

    <!-- Footer Branding -->
    <div class="cpe-footer">
        <div class="footer-brand">
            <span class="brand-ka">Kelley</span>
            <span class="brand-ka-austin"><span class="brand-diamond"></span>Austin</span>
            <span class="brand-separator"></span>
            <span class="brand-nowpart">NOW PART OF</span>
            <span class="brand-perficient"><span class="brand-p">P</span>ERFICIENT</span>
        </div>
        <div class="footer-version">Version: <span class="version-number">26.W</span></div>
    </div>
</template>
